<!DOCTYPE HTML>
<HEAD>
  <TITLE>å›¾ç‰‡æŸ¥çœ‹ä¸æ ‡è®°å·¥å…·</TITLE>
  <META charset="UTF-8">
  <META name="viewport" content="width=device-width, initial-scale=1.0">
  <META name="Description" content="ä¸€ä¸ªç®€å•çš„åœ¨çº¿å›¾ç‰‡æŸ¥çœ‹å’Œæ ‡è®°å·¥å…·">
  <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>ğŸ–¼ï¸</text></svg>">
  <META NAME="Generator" CONTENT="EditPlus">
  <META NAME="Author" CONTENT="">
  <META NAME="Keywords" CONTENT="">

<style type="text/css">
img {
    width: auto;
    height: auto;
    max-width: 300px;
    max-height: 300px;
    object-fit: contain;
    transition: transform 0.2s;
}

img:hover {
    transform: scale(1.05);
}

table {
    border-collapse: collapse;
    width: 100%;
    margin: 20px 0;
}

th, td {
    padding: 12px;
    text-align: center;
    border: 1px solid #ddd;
}

th {
    background-color: #f5f7fa;
    color: #606266;
}

tr:hover {
    background-color: #f5f7fa;
}

.button {
    padding: 8px 15px;
    margin: 5px;
    border: 1px solid #dcdfe6;
    border-radius: 4px;
    background: white;
    color: #409eff;
    cursor: pointer;
    transition: all 0.3s;
}

.button:hover {
    background: #409eff;
    color: white;
    border-color: #409eff;
}

textarea {
    border: 1px solid #dcdfe6;
    border-radius: 4px;
    padding: 10px;
    font-family: monospace;
    resize: vertical;
}

#divURL, #divImg {
    padding: 20px;
    background: white;
    border-radius: 8px;
    box-shadow: 0 2px 12px 0 rgba(0,0,0,0.1);
}

label {
    color: #606266;
    margin-right: 10px;
}

.marked {
    background-color: #ff00ff;
    color: #ffffff;
}

@media (max-width: 768px) {
    textarea {
        width: 95% !important;
        height: 200px !important;
    }
    
    img {
        max-width: 150px;
        max-height: 150px;
    }
    
    .button {
        width: 100%;
        margin: 5px 0;
    }
}

.instructions {
    background: #f8f9fa;
    padding: 15px;
    border-radius: 8px;
    margin-bottom: 20px;
}

.instructions ol {
    margin: 10px 0;
    padding-left: 20px;
}

.instructions li {
    margin: 5px 0;
    color: #606266;
}

.copy-button {
    position: absolute;
    right: 10px;
    top: 10px;
    padding: 5px 10px;
    background: #409eff;
    color: white;
    border: none;
    border-radius: 4px;
    cursor: pointer;
}

.copy-button:hover {
    background: #66b1ff;
}

.result-area {
    position: relative;
}

.success-toast {
    position: fixed;
    top: 20px;
    right: 20px;
    padding: 10px 20px;
    background: #67C23A;
    color: white;
    border-radius: 4px;
    display: none;
    animation: fadeIn 0.3s;
}

@keyframes fadeIn {
    from { opacity: 0; transform: translateY(-20px); }
    to { opacity: 1; transform: translateY(0); }
}

.loading {
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: rgba(255,255,255,0.8);
    display: flex;
    justify-content: center;
    align-items: center;
    display: none;
}

.loading-spinner {
    width: 50px;
    height: 50px;
    border: 5px solid #f3f3f3;
    border-top: 5px solid #409eff;
    border-radius: 50%;
    animation: spin 1s linear infinite;
}

@keyframes spin {
    0% { transform: rotate(0deg); }
    100% { transform: rotate(360deg); }
}
</style>

<script language="javascript">
//èƒ½å¦å¼„ä¸€ä¸ªå…¬ç”¨çš„æ–¹æ³•ï¼Œè´´å…¥urlå³å¯äº§ç”Ÿä¸€ä¸ªè¡¨æ ¼ï¼Œ
//ä½¿å¾—æ¯ä¸ªå›¾ç‰‡ç‚¹å‡»ä¸€ä¸‹ï¼Œå³å¯æ ‡è®°æ˜¯å¦æ˜¯æ¶æ„å›¾ç‰‡
//æœ€åè¡¨æ ¼å¯ä»¥å¤åˆ¶å‡ºæ¥ï¼Œä»¥ä¾¿å¯¹æ¯”
//jsä¸æ–¹ä¾¿å¤„ç†çš„è¯ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨cgi

//ä»xmlæ–‡æ¡£ä¸­å¾—åˆ°æŒ‡å®šåå­—ç»“ç‚¹(åªå¾—åˆ°æ–‡æ¡£ä¸­ç¬¬ä¸€ä¸ªè¯¥åç§°ç»“ç‚¹)
function getUniqueNode(xmlRoot,nodeName){
	if ( xmlRoot == null ) {
		return null;
	}
	var temp = xmlRoot.getElementsByTagName(nodeName);
	if (temp.length == 0)
	{
		//window.alert("in getUniqueNode("+nodeName+").length == 0");
		return null;
	}
	else{
		return temp[0];
	}
}

/***************
 * @FuncName:	ClearTabData
 * @Desc:		æ¸…é™¤æŒ‡å®šçš„tabä¸­çš„æ‰€æœ‰è¡Œï¼ŒåŒ…æ‹¬è¡¨å¤´
 * @Param:		objTab: æŒ‡å®šçš„è¦æ¸…é™¤æ‰€æœ‰å…ƒç´ çš„table obj
 * @Param:		isSkipTH	,æ˜¯å¦è¦æ¸…é™¤è¡¨å¤´
 * @Return:		æˆåŠŸè¿”å›trueï¼Œå¦åˆ™è¿”å›false
 * @Author:		kennyli
 * @Date:		20080331
 */
function ClearTabData(objTab,isSkipTH)
{
	//make sure that objTab is a table
	if ( objTab == null )
	{
		window.alert("objTab is null");
		return false;
	}
	if ( objTab.nodeName != "TABLE" )
	{
		window.alert("objTab="+objTab+":"+objTab.nodeName+" is not a TABLE!");
		return false;
	}
	if ( !objTab.hasChildNodes() )
	{
		window.alert("objTab has no child");
		return false;
	}

	//get tbody of the table
	var curNode;
	for ( curNode = objTab.firstChild; curNode != null; curNode=curNode.nextSibling )
	{
		//alert("in table"+objTab.id+"'s node: "+curNode.nodeName);
		if (curNode.nodeName == "TBODY")
			break;
	}
	if (curNode == null)
	{	//cannot find tbody
		window.alert("obj has no child named TBODY,try to add a TBODY");
		curNode = document.createElement("TBODY");
		objTab.appendChild(curNode);
	}

	//remove all rows
	var count=curNode.childNodes.length;
	for (var i=count-1; i>=0; i--)
	{
		var subNode ;
		if ( curNode.childNodes[i].nodeName=="TR" && 
			getUniqueNode(curNode.childNodes[i], "TH") != null  ) {
			if ( !isSkipTH  ) {
				//å¦‚æœè®¾ç½®éœ€è¦æ¸…ç†è¡¨å¤´,åˆ™æ¸…ç†è¡¨å¤´
				curNode.removeChild(curNode.childNodes[i]);
			}
		}
		else
		{
			curNode.removeChild(curNode.childNodes[i]);
		}
	}
	/* è¿™ç§æ–¹å¼æ— æ³•è¿‡æ»¤æ¡ä»¶,å› ä¸ºå¦‚æœæŸä¸ªç»“ç‚¹æƒ³è·³è¿‡,åˆ™ä¼šäº§ç”Ÿæ­»å¾ªç¯
	while( curNode.childNodes.length > 0 ) {
		if ( curNode.childNodes[0].nodeName=="TH") {
			if ( !isSkipTH  ) {
				//å¦‚æœè®¾ç½®éœ€è¦æ¸…ç†è¡¨å¤´,åˆ™æ¸…ç†è¡¨å¤´
				curNode.removeChild(curNode.childNodes[0]);
			}
		}
		else
		{
			curNode.removeChild(curNode.childNodes[0]);
		}
	}
	*/

	return true;
}

//äº§ç”Ÿä¸€ä¸ªtextçš„tdå…ƒç´ ,idæŒ‡å®šä¸ºidname
function CreateCellWithText(text,idname) {
	var cell = document.createElement("td");
	cell.id=idname;
	cell.appendChild(document.createTextNode(text));
	return cell;
}

//äº§ç”Ÿä¸€ä¸ªtextçš„thå…ƒç´ 
function CreateHeadCellWithText(text,idname) {
	var cell = document.createElement("th");
	cell.id=idname;
	cell.appendChild(document.createTextNode(text));
	return cell;
}

//äº§ç”Ÿä¸€ä¸ªå¸¦é¢œè‰²çš„textç±»å‹çš„tdå…ƒç´ 
function CreateCellWithTextColor(text,color,idname){
	var cell = document.createElement("td");
	var textelement  = document.createTextNode(text);
	cell.id=idname;
	cell.appendChild(textelement);
	cell.style.color = color;
	return cell;
}

//äº§ç”Ÿä¸€ä¸ªå›¾ç‰‡çš„tdå…ƒç´ 
function CreateCellWithImage(imagePath,idname,imgid){
	var cell = document.createElement("td");
	//var div = document.createElement("div");
	var image = document.createElement("img");
	image.id=imgid;
	image.src=imagePath;
	//div.appendChild(image);
	cell.id=idname;
	//cell.appendChild(div);
	cell.appendChild(image);
	return cell;
}



function bodyclickHandler(evt)
{
    //var evt = window.event || evt;  //å–äº‹ä»¶
    var obj = evt.srcElement || evt.target; //å–äº‹ä»¶æº
	//alert("clicked:"+obj.id);
	var idprefix=obj.id.substring(0,5);
	var idnum = obj.id.substr(5);
	if("valTD"==idprefix)
	{
		//alert(idnum);
		var valObj = document.getElementById("valTD"+idnum);
		if(valObj.innerHTML==1){
			valObj.style.color="#000000";
			valObj.style.backgroundColor="#ffffff";
			valObj.innerHTML = 0;
		}
		else{
			valObj.style.color="#ff0000";
			valObj.style.backgroundColor="#ff00ff";
			valObj.innerHTML = 1;
		}
		getMarkedImgUrl();
	}
	else if("myimg"==idprefix)
	{
		//alert("img "+idnum+" was clicked! URL="+obj.src);
		window.open(obj.src);
	}
}

</script>
</HEAD>

<BODY onclick=bodyclickHandler(event)>

<div id="divURL" style="display:block">
	<h1>å›¾ç‰‡æŸ¥çœ‹ä¸æ ‡è®°å·¥å…·</h1>
	<div class="instructions">
		<h3>ä½¿ç”¨è¯´æ˜ï¼š</h3>
		<ol>
			<li>åœ¨ä¸‹æ–¹æ–‡æœ¬æ¡†ä¸­è¾“å…¥å›¾ç‰‡URLï¼Œæ¯è¡Œä¸€ä¸ª</li>
			<li>ç‚¹å‡»"æ˜¾ç¤ºå›¾ç‰‡"æŒ‰é’®æŸ¥çœ‹æ‰€æœ‰å›¾ç‰‡</li>
			<li>ç‚¹å‡»å›¾ç‰‡å•å…ƒæ ¼å¯ä»¥æ ‡è®°/å–æ¶ˆæ ‡è®°è¯¥å›¾ç‰‡</li>
			<li>ç‚¹å‡»"è·å–è¢«æ ‡è®°å›¾ç‰‡çš„URL"å¯ä»¥å¾—åˆ°æ‰€æœ‰æ ‡è®°å›¾ç‰‡çš„é“¾æ¥</li>
		</ol>
	</div>
	<label>è¯·è¾“å…¥å›¾ç‰‡URLï¼ˆæ¯è¡Œä¸€ä¸ªï¼‰ï¼š</label>
	<input type="button" class="button" value="æ˜¾ç¤ºå›¾ç‰‡" onclick="loadImg()"/>
	<br/>
	<textarea cols="40" rows="15" style="width:850px;height:400px;" 
			  name="idTxtAreaUrl" id="idTxtAreaUrl" 
			  placeholder="è¯·è¾“å…¥å›¾ç‰‡URLï¼Œæ¯è¡Œä¸€ä¸ª
ä¾‹å¦‚ï¼š
https://example.com/image1.jpg
https://example.com/image2.png
https://example.com/image3.jpg"></textarea>
</div>

<div id="divImg" style="display:none">
	<table id="table1">
		<thead>
			<tr>
				<th>ID</th>
				<th>å›¾ç‰‡</th>
				<th>æ˜¯å¦åšæ ‡è®°</th>
			</tr>
		</thead>
		<tbody id="idTable">
		</tbody>
	</table>
	<div class="button-group">
		<input type="button" class="button" value="è·å–è¢«æ ‡è®°å›¾ç‰‡çš„URL" onclick="getMarkedImgUrl()"/>
		<input type="button" class="button" value="è¿”å›" onclick="location.reload()"/>
	</div>
	<div class="result-area">
		<div class="result-header">
			<label>è¢«æ ‡è®°å›¾ç‰‡çš„URLåˆ—è¡¨ï¼š</label>
			<span id="labelMarkedImgCnt"></span>
		</div>
		<div style="position: relative;">
			<textarea cols="40" rows="5" style="width:850px;height:200px;" 
					  name="idTxtAreaMarkedUrl" 
					  id="idTxtAreaMarkedUrl"></textarea>
			<button class="copy-button" onclick="copyUrls()">å¤åˆ¶URL</button>
		</div>
	</div>
</div>

<div id="successToast" class="success-toast">å¤åˆ¶æˆåŠŸ!</div>
<div id="loading" class="loading">
	<div class="loading-spinner"></div>
</div>

</BODY>


<script language="javascript">

	function getMarkedImgUrl() {
		var tabBody = document.getElementById("idTable");
		var dstTxtArea = document.getElementById("idTxtAreaMarkedUrl");
		dstTxtArea.innerHTML="";
		var cnt=0;
		for (var i=0; i<tabBody.rows.length;i++) {
			//if(1==tabBody.rows[i].cells[2].innerHTML){
			if(1==document.getElementById("valTD"+i).innerHTML){
				//è®²è¯¥åˆ—çš„URLè´´åˆ°ä¸‹é¢çš„è¡¨æ ¼ä¸­
				//dstTxtArea.innerHTML+=tabBody.rows[i].cells[1].firstChild.src;
				dstTxtArea.innerHTML+=document.getElementById("myimg"+i).src;
				dstTxtArea.innerHTML+="\n";
				cnt++;
			}
		}
		if(0==cnt) {
			document.getElementById("labelMarkedImgCnt").innerHTML="<b>æ²¡æœ‰æ ‡è®°ä»»ä½•å›¾ç‰‡ï¼</b>";
			document.getElementById("labelMarkedImgCnt").style.color="red";
		}
		else{
			document.getElementById("labelMarkedImgCnt").innerHTML="<b>å…±æ ‡è®°äº† "+cnt+" å¼ å›¾ç‰‡ï¼</b>";
			document.getElementById("labelMarkedImgCnt").style.color="blue";
			//alert("é€‰ä¸­äº†"+cnt+"å¼ å›¾ï¼");
		}
		
	}

	function addEventHandler(oTarget, sEventType, fnHandler) {  
		if (oTarget.addEventListener) {  
			oTarget.addEventListener(sEventType, fnHandler, false);  
		} else if (oTarget.attachEvent) {  
			oTarget.attachEvent("on" + sEventType, fnHandler);  
		} else {  
			oTarget["on" + sEventType] = fnHandler;  
		}  
	};  

	function clickHandler(opObjID){
		var opObj = document.getElementById(opObjID);
		if(null==opObj || "undefined"==opObj)
		{
			//alert("onclick:"+opObjID);
			return;
		}
		opObj.style.color = "#ff0000"
	}

	function copyUrls() {
		const textarea = document.getElementById('idTxtAreaMarkedUrl');
		textarea.select();
		document.execCommand('copy');
		
		const toast = document.getElementById('successToast');
		toast.style.display = 'block';
		setTimeout(() => {
			toast.style.display = 'none';
		}, 2000);
	}

	function showLoading() {
		document.getElementById('loading').style.display = 'flex';
	}

	function hideLoading() {
		document.getElementById('loading').style.display = 'none';
	}

	// ä¿®æ”¹loadImgå‡½æ•°ï¼Œæ·»åŠ åŠ è½½åŠ¨ç”»
	function loadImg(){
		showLoading();
		setTimeout(() => {
			var objDivUrl = document.getElementById("divURL");
			var objDivImg = document.getElementById("divImg");
			objDivUrl.style.display="none";
			objDivImg.style.display="block";

			var ObjURLTxt = document.getElementById("idTxtAreaUrl");
			//var content   = ObjURLTxt.value.split('\n').join('<br>');
			var content   = ObjURLTxt.value.split('\n');
			var arrImgUrl = content;
			
			//alert(arrImgUrl);
			///*
			ClearTabData(document.getElementById("table1"),false);
			
			for ( var i=0; i<arrImgUrl.length; i++ )
			{
				if(arrImgUrl[i].length==0)
				{
					//alert("0 len:"+arrImgUrl[i]);
					continue;
				}
				var tabBody = document.getElementById("idTable");
				var row=document.createElement("tr");
				var idTD = CreateCellWithText(i+1,"idTD"+i);
				var imgTD = CreateCellWithImage(arrImgUrl[i],"imgTD"+i,"myimg"+i);
				var txtTD = CreateCellWithText("0","valTD"+i);
				//imgTD.onclick=clickHandler("val"+i);	//IEä¸‹è¿›å…¥é¡µé¢å°±è§¦å‘ï¼Œä¸”ä¸èƒ½æ­£å¸¸è¿è¡Œï¼Œæç¤ºå°šæœªå®ç°ï¼›FFä¸‹è¿›å…¥é¡µé¢å°±è§¦å‘
				//addEventHandler(imgTD,"click",		//
				row.appendChild(idTD);
				row.appendChild(imgTD);
				row.appendChild(txtTD);
				tabBody.appendChild(row);
				//alert("Now we got "+i+"rows");
			}
			//*/
			hideLoading();
		}, 100);
	}

	//loadImg();

	// æ·»åŠ æ‹–æ‹½ä¸Šä¼ åŠŸèƒ½
	function handleDrop(e) {
		e.preventDefault();
		e.stopPropagation();
		
		const textarea = document.getElementById('idTxtAreaUrl');
		const files = e.dataTransfer.files;
		
		for(let i = 0; i < files.length; i++) {
			const file = files[i];
			if(file.type.startsWith('image/')) {
				const reader = new FileReader();
				reader.onload = function(e) {
					textarea.value += e.target.result + '\n';
				}
				reader.readAsDataURL(file);
			}
		}
	}

	function handleDragOver(e) {
		e.preventDefault();
		e.stopPropagation();
	}

	// åœ¨é¡µé¢åŠ è½½å®Œæˆåæ·»åŠ æ‹–æ‹½äº‹ä»¶ç›‘å¬
	window.onload = function() {
		const textarea = document.getElementById('idTxtAreaUrl');
		textarea.addEventListener('drop', handleDrop);
		textarea.addEventListener('dragover', handleDragOver);
	}

</script>

</HTML>

